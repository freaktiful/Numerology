/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package Numerology;

import static org.junit.jupiter.api.Assertions.assertEquals;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import org.junit.jupiter.api.Test;


public class NumerologyTest {
    @Test 
    public void testReplaceEachNineForTwoTens() {
        Numerology numerology = new Numerology();
        assertEquals(Arrays.asList(1,1,5,3,3,3,3,3,3,3,3,3,3,3,3,7,8,10,10,10), numerology.generateOutput(Arrays.asList(1,2,3,4,4,6,7,8,9,10)));
    }
    
    @Test
    public void testReplaceAllTwosByOnesNumberToTheLeft() {
    	Numerology numerology = new Numerology();
        assertEquals(Arrays.asList(5,1,1,1,5,3,5), numerology.generateOutput(Arrays.asList(3,2,3,4,5)));
    }
    
    @Test
    public void testReplaceAllSixsByThreesNumberToTheRightPositionsNumberToTheLeft () {
    	Numerology numerology = new Numerology();
        assertEquals(Arrays.asList(1,3,3,3,5,3,5), numerology.generateOutput(Arrays.asList(1,6,3,4,5)));
    }
    
    @Test
    public void testReplaceEachThreeWithFiveIfNotFollowedByFiveAndReplaceEachFourByThreeIfNotPreceededByFive() {
    	Numerology numerology = new Numerology();
    	assertEquals(Arrays.asList(3,5), numerology.generateOutput(Arrays.asList(3,5)));
    	assertEquals(Arrays.asList(5,15), numerology.generateOutput(Arrays.asList(3,15)));
    	assertEquals(Arrays.asList(5,4), numerology.generateOutput(Arrays.asList(5,4)));
    	assertEquals(Arrays.asList(15,3), numerology.generateOutput(Arrays.asList(15,4)));
    }
    
    
    public class Numerology {
	
    	public List<ApplyRuleInterface> rules = 
    			Arrays.asList(
    					new NoRule(), 
    					new NoRule(), 
    					new RuleReplaceTwosForOnes(),
    					new RuleReplaceThreeByFive(),
    					new RuleReplaceFourByThree(),
    					new NoRule(),
    					new RuleReplaceSixsForThrees(),
    					new NoRule(),
    					new NoRule(),
    					new RuleReplaceNineForTens()
    			);
    	
    	public List<Integer> generateOutput(List<Integer> input) {
    		List<Integer> output = new ArrayList<Integer>();
    		for (int i = 0; i< input.size(); i++) {
    			if (input.get(i) < 10) {
    				output.addAll(rules.get(input.get(i)).applyRule(input, i));
    			} else {
    				output.addAll(new NoRule().applyRule(input, i));
    			}
    		}
    		return output;
    	}
    }
    
    public interface ApplyRuleInterface {   	
    	
		public List<Integer> applyRule(List<Integer> input, Integer index);
    }
    
    public class NoRule implements ApplyRuleInterface {
    	public List<Integer> applyRule(List<Integer> input, Integer index) {
    		return Arrays.asList(input.get(index));
    	}
    }
    
    public class RuleReplaceNineForTens implements ApplyRuleInterface {    	
		public List<Integer> applyRule(List<Integer> input, Integer index) {
			return Arrays.asList(10, 10);
		}
    }
    
    public class RuleReplaceTwosForOnes implements ApplyRuleInterface {  	
		public List<Integer> applyRule(List<Integer> input, Integer index) {
			List<Integer> output = new ArrayList<Integer>();
			for(int j=0; j<input.get(index-1); j++) {
				output.add(1);
    		}
			return output;
    	}
    }
    
    public class RuleReplaceSixsForThrees implements ApplyRuleInterface {
		public List<Integer> applyRule(List<Integer> input, Integer i) {
			List<Integer> output = new ArrayList<Integer>();
			Integer index = input.get(i-1);
    		for (int j=0; j<input.get(i + index); j++) {
    			output.add(3);
    		}
    		return output;
		}
    }
    
    public class RuleReplaceThreeByFive implements ApplyRuleInterface {
    	public List<Integer> applyRule(List<Integer> input, Integer index) {
    		Integer following = input.get(index + 1);
    		if (!following.equals(5)) {
    			return Arrays.asList(5);
    		} else {
    			return Arrays.asList(input.get(index));
    		}
    	}
    }
    
    public class RuleReplaceFourByThree implements ApplyRuleInterface {
    	public List<Integer> applyRule(List<Integer> input, Integer index) {
    		Integer preceeded = input.get(index - 1);
    		if(!preceeded.equals(5)) {
    			return Arrays.asList(3);
    		} else {
    			return Arrays.asList(input.get(index));
    		}
    	}
    }
}
